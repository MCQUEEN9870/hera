# Project name
spring.application.name=herapherigoods

# PostgreSQL (Supabase) database config (env-overridable)
spring.datasource.url=${DB_URL:jdbc:postgresql://db.kmwcinmjonqetgircdtr.supabase.co:5432/postgres?sslmode=require}
spring.datasource.username=${DB_USER:postgres}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=org.postgresql.Driver

# Hibernate config (dev-friendly defaults)
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update

# Premium pricing (server-authoritative). Amounts are in INR.
app.premium.pricing.monthly.inr=59
app.premium.pricing.quarterly.inr=159
app.premium.pricing.half-yearly.inr=299
app.premium.pricing.yearly.inr=499

# Step 7: Rate limiting (defaults). Tune in production via env vars.
app.ratelimit.auth.login.ip.limit=10
app.ratelimit.auth.login.ip.window-seconds=300
app.ratelimit.auth.login.contact.limit=5
app.ratelimit.auth.login.contact.window-seconds=300

# Next step: Password login lockout (per contact number, in-memory)
app.auth.lockout.max-failures=5
app.auth.lockout.window-seconds=600
app.auth.lockout.lock-seconds=600

app.ratelimit.auth.check-user.ip.limit=30
app.ratelimit.auth.check-user.ip.window-seconds=60

app.ratelimit.auth.signup.ip.limit=10
app.ratelimit.auth.signup.ip.window-seconds=600
app.ratelimit.auth.signup.contact.limit=3
app.ratelimit.auth.signup.contact.window-seconds=600

app.ratelimit.auth.otp.verify.ip.limit=25
app.ratelimit.auth.otp.verify.ip.window-seconds=300
app.ratelimit.auth.otp.verify.contact.limit=10
app.ratelimit.auth.otp.verify.contact.window-seconds=300

app.ratelimit.payments.create-order.ip.limit=10
app.ratelimit.payments.create-order.ip.window-seconds=60
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Flyway
# If `flyway_schema_history` was deleted but the schema already has tables,
# baseline will recreate the history table so the app can start.
spring.flyway.baseline-on-migrate=true
spring.flyway.schemas=public
spring.flyway.default-schema=public

# Disable entity scanning for DeletedVehicle and DeletedUser
spring.jpa.properties.hibernate.exclude-auto-scan-entities=com.example.demo.model.DeletedVehicle,com.example.demo.model.DeletedUser

# Enable SQL logging (dev only)
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Enable service/controller logs for location resolution
logging.level.com.example.demo=INFO

# File Upload Settings
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB

# Supabase custom configs (env-overridable)
supabase.url=${SUPABASE_URL:https://kmwcinmjonqetgircdtr.supabase.co}
supabase.key=${SUPABASE_KEY:}
supabase.bucket.name=${SUPABASE_BUCKET:vehicle-images}
supabase.profile.bucket.name=${SUPABASE_PROFILE_BUCKET:profile-photos}

# Server
server.port=${PORT:8080}
server.forward-headers-strategy=framework

# CORS (dev + prod). Comma-separated list. Include "null" for file:// testing
app.cors.allowed-origins=http://localhost:5500,http://127.0.0.1:5500,http://localhost:3000,http://localhost:8080,https://herapherigoods.in,https://www.herapherigoods.in,https://api.herapherigoods.in,null

# CAPTCHA(disabled in dev). When enabled, backend will verify tokens
captcha.enabled=false
captcha.secret=${CAPTCHA_SECRET:}


# Razorpay (env-overridable)
razorpay.key.id=${RAZORPAY_KEY_ID:}
razorpay.key.secret=${RAZORPAY_KEY_SECRET:}

# 2Factor SMS (env-overridable)
twofactor.api.key=${TWOFACTOR_API_KEY:}
sms.enabled=${SMS_ENABLED:true}
sms.sender.id=${SMS_SENDER_ID:HPIGDS}
twofactor.template.login=${TWOFACTOR_TEMPLATE_LOGIN:userloginotp}
twofactor.template.signup=${TWOFACTOR_TEMPLATE_SIGNUP:usersignup}
twofactor.autogen.template-only=${TWOFACTOR_AUTOGEN_TEMPLATE_ONLY:true}

# Email (Brevo Transactional)
mail.enabled=${MAIL_ENABLED:true}
mail.notifications.enabled=${MAIL_NOTIFICATIONS_ENABLED:true}
brevo.api.key=${BREVO_API_KEY:}
mail.from.email=${MAIL_FROM_EMAIL:info@herapherigoods.in}
mail.from.name=${MAIL_FROM_NAME:Herapherigoods Team}

# Branding used in emails
app.site.name=${APP_SITE_NAME:Herapherigoods}
app.site.url=${APP_SITE_URL:https://www.herapherigoods.in}
app.site.logo.url=${APP_SITE_LOGO_URL:https://www.herapherigoods.in/attached_assets/images/1200x630.jpg}

# Email OTP password reset
security.password-reset.email-otp.enabled=${SECURITY_PWRESET_EMAIL_OTP_ENABLED:true}
security.password-reset.email-otp.ttl-seconds=${SECURITY_PWRESET_EMAIL_OTP_TTL_SECONDS:60}
security.password-reset.email-otp.reset-token-ttl-minutes=${SECURITY_PWRESET_EMAIL_OTP_TOKEN_TTL_MINUTES:10}
security.password-reset.email-otp.pepper=${SECURITY_PWRESET_EMAIL_OTP_PEPPER:CHANGE_ME_IN_PROD}

# Email OTP security policy
security.password-reset.email-otp.max-attempts=${SECURITY_PWRESET_EMAIL_OTP_MAX_ATTEMPTS:15}


# Email scheduling / reminders (uses the same mail.enabled flag above)
mail.admin.to=${MAIL_ADMIN_TO:info@herapherigoods.in}

# Scheduled reminders (OFF by default)
mail.reminders.enabled=${MAIL_REMINDERS_ENABLED:false}
mail.reminders.cron=${MAIL_REMINDERS_CRON:0 0 10 * * *}
mail.reminders.signup-no-vehicle.days=${MAIL_REMINDER_SIGNUP_NO_VEHICLE_DAYS:2,7}
mail.reminders.batch-size=${MAIL_REMINDERS_BATCH_SIZE:200}

# Welcome email optimization (avoid wasted usage)
mail.welcome.delayed.enabled=${MAIL_WELCOME_DELAYED_ENABLED:true}
mail.welcome.delayed.delay-minutes=${MAIL_WELCOME_DELAY_MINUTES:5}
mail.welcome.delayed.cron=${MAIL_WELCOME_DELAY_CRON:0 * * * * *}
mail.welcome.delayed.batch-size=${MAIL_WELCOME_DELAY_BATCH_SIZE:200}

# Docs reminders (RC/DL) - OFF by default
mail.docs.reminders.enabled=${MAIL_DOCS_REMINDERS_ENABLED:false}
mail.docs.reminders.cron=${MAIL_DOCS_REMINDERS_CRON:0 30 10 * * *}
mail.docs.reminders.batch-size=${MAIL_DOCS_REMINDERS_BATCH_SIZE:200}
mail.docs.reminders.first-after-days=${MAIL_DOCS_REMINDERS_FIRST_AFTER_DAYS:2}
mail.docs.reminders.second-after-days=${MAIL_DOCS_REMINDERS_SECOND_AFTER_DAYS:30}

# Require email confirmation for destructive actions
deletion.confirmation.required=${DELETION_CONFIRMATION_REQUIRED:true}

# Site branding (used in transactional emails)
app.api.url=${APP_API_URL:https://api.herapherigoods.in}

# Social links (used in email footer)
app.social.youtube.url=${APP_SOCIAL_YOUTUBE_URL:https://youtu.be/FREi_Lb4gWY}
app.social.facebook.url=${APP_SOCIAL_FACEBOOK_URL:https://www.facebook.com/share/1AYuAxKGzs/}
app.social.whatsapp.group.url=${APP_SOCIAL_WHATSAPP_GROUP_URL:https://chat.whatsapp.com/LMUfgwk7qwOCh7p4Gxy0tc}

# Brevo Transactional Email API
brevo.api.key=${BREVO_API_KEY:}
brevo.api.base-url=${BREVO_API_BASE_URL:https://api.brevo.com/v3}
brevo.sender.name=${BREVO_SENDER_NAME:Herapherigoods Team}

# Protected test endpoint (/api/mail/test)
mail.test.token=${MAIL_TEST_TOKEN:}

