[build]
  publish = "hera pheri goods"

[build.processing]
  skip_processing = false

[build.processing.html]
  pretty_urls = true

[build.processing.js]
  bundle = false
  minify = true

[build.processing.css]
  bundle = false
  minify = true

[build.processing.images]
  compress = true

# Prefer static pages for these exact paths (place BEFORE any SSR rewrites)
[[redirects]]
  from = "/register"
  to = "/register.html"
  status = 200
  force = true

[[redirects]]
  from = "/register/"
  to = "/register.html"
  status = 200
  force = true

[[redirects]]
  from = "/vehicles"
  to = "/vehicles.html"
  status = 200
  force = true

[[redirects]]
  from = "/vehicles/"
  to = "/vehicles.html"
  status = 200
  force = true

# Vehicles deep-links should render the SPA vehicles page
[[redirects]]
  from = "/vehicles/*"
  to = "/vehicles.html"
  status = 200
  force = true

# Register subpaths (if any) should land on register page too
[[redirects]]
  from = "/register/*"
  to = "/register.html"
  status = 200
  force = true

[[redirects]]
  from = "/city/*"
  to = "/index.html"
  status = 200
  force = true

# Keep homepage on Netlify (do not proxy "/" to backend)

# Clean URLs without .html extensions (200 = success, no redirect)
[[redirects]]
  from = "/login"
  to = "/login.html"
  status = 200

[[redirects]]
  from = "/register"
  to = "/register.html"
  status = 200
  force = true

[[redirects]]
  from = "/vehicles"
  to = "/vehicles.html"
  status = 200
  force = true

[[redirects]]
  from = "/driver-dashboard"
  to = "/driver-dashboard.html"
  status = 200

[[redirects]]
  from = "/contact-us"
  to = "/contact-us.html"
  status = 200

[[redirects]]
  from = "/privacy-policy"
  to = "/privacy-policy.html"
  status = 200

[[redirects]]
  from = "/terms-and-conditions"
  to = "/terms-and-condition.html"
  status = 200

[[redirects]]
  from = "/refer-and-refund-policy"
  to = "/refer-and-refund-policy.html"
  status = 200

# Redirect .html extensions to clean URLs (301 = permanent redirect)
[[redirects]]
  from = "/login.html"
  to = "/login"
  status = 301

[[redirects]]
  from = "/register.html"
  to = "/register"
  status = 301

[[redirects]]
  from = "/vehicles.html"
  to = "/vehicles"
  status = 301

[[redirects]]
  from = "/driver-dashboard.html"
  to = "/driver-dashboard"
  status = 301

[[redirects]]
  from = "/contact-us.html"
  to = "/contact-us"
  status = 301

[[redirects]]
  from = "/privacy-policy.html"
  to = "/privacy-policy"
  status = 301

[[redirects]]
  from = "/terms-and-condition.html"
  to = "/terms-and-conditions"
  status = 301

[[redirects]]
  from = "/refer-and-refund-policy.html"
  to = "/refer-and-refund-policy"
  status = 301

# Pretty image proxy to backend derivative (watermarked)
[[redirects]]
  from = "/images/vehicles/:id/*"
  to = "https://api.herapherigoods.in/api/images/vehicles/:id/:splat"
  status = 200
  force = true

# SPA fallback redirect (must be last)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

############################################
# Cache-Control headers (performance)
############################################

# HTML: always revalidate to get the latest shell
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# CSS & JS: long-term immutable caching
[[headers]]
  for = "/*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Static assets: images, fonts, videos
[[headers]]
  for = "/attached_assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/attached_assets/*/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/attached_assets/*/*/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Web manifest and icons can be cached for a week
[[headers]]
  for = "/site.webmanifest"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "/favicon.ico"
  [headers.values]
    Cache-Control = "public, max-age=604800"

# Cache pretty-proxied vehicle images aggressively
[[headers]]
  for = "/images/vehicles/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"


